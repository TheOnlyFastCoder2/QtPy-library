## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [üöÄ –°–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞](#-—Å–æ–∑–¥–∞–Ω–∏–µ-—Ö—Ä–∞–Ω–∏–ª–∏—â–∞)
2. [üì¢ subscribe](#-subscribe)
3. [üéØ subscribeToPath](#-subscribetopath)
4. [‚úèÔ∏è update](#Ô∏è-update)
5. [üîç get](#-get)
6. [‚ôªÔ∏è invalidate](#-invalidate)
7. [‚è≥ asyncUpdate](#-asyncupdate)
8. [üì¶ batch](#-batch)
9. [‚Ü©Ô∏è undo / ‚Ü™Ô∏è redo](#Ô∏è-undo--Ô∏è-redo)
10. [üõ£Ô∏è resolvePath](#Ô∏è-resolvepath)
11. [üßπ manualCleanup](#-manualcleanup)
12. [üìä getMemoryStats](#-getmemorystats)
13. [üóëÔ∏è clearStore](#-clearstore)
14. [üè∑Ô∏è state / üõ†Ô∏è `$`](#Ô∏è-state--Ô∏è-)
15. [üîó –û–±—â–∏–π –ø—Ä–∏–º–µ—Ä](#-–æ–±—â–∏–π-–ø—Ä–∏–º–µ—Ä)

---

## üöÄ –°–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

> **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
> –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å –ø–æ–¥–ø–∏—Å–∫–∞–º–∏, –∫–µ—à-–∫–ª—é—á–∞–º–∏, –∏—Å—Ç–æ—Ä–∏–µ–π –∏ –±–∞—Ç—á–∏–Ω–≥–æ–º.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
function createObservableStore<T extends object>(
  initialState: T,
  middlewares?: Middleware<T>[],
  options?: {
    maxHistoryLength?: number;
    cleanupInterval?: number;
  }
): ObservableStore<T>;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- **state** —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ (–ø—Ä—è–º–æ–µ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç).
- **–ü–æ–¥–ø–∏—Å–∫–∏** –Ω–∞ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—É—Ç—è–º.
- **CacheKey** –¥–ª—è –≤—ã–±–æ—Ä–æ—á–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
- **–ò—Å—Ç–æ—Ä–∏—è** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ `undo`/`redo`.
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ** –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ—Ç–º–µ–Ω—ã.
- **Batching** –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞ –æ–¥–∏–Ω —Ü–∏–∫–ª –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π.
- **–ê–≤—Ç–æ-–æ—á–∏—Å—Ç–∫–∞** –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏.

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ò–º—è                   | –¢–∏–ø               | –û–ø–∏—Å–∞–Ω–∏–µ                                           |
| --------------------- | ----------------- | -------------------------------------------------- |
| `initialState`        | `T`               | –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ª—é–±–æ–π –æ–±—ä–µ–∫—Ç).                |
| `middlewares?`        | `Middleware<T>[]` | –ú–∞—Å—Å–∏–≤ —Ñ—É–Ω–∫—Ü–∏–π-–ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–æ–≤ `update`.             |
| `options?`            | `{‚Ä¶}`             | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:                          |
| ‚îî `maxHistoryLength?` | `number`          | –ú–∞–∫—Å. —á–∏—Å–ª–æ –∑–∞–ø–∏—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞ –ø—É—Ç—å.               |
| ‚îî `cleanupInterval?`  | `number`          | –ò–Ω—Ç–µ—Ä–≤–∞–ª (–º—Å) –∞–≤—Ç–æ-–æ—á–∏—Å—Ç–∫–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –∏—Å—Ç–æ—Ä–∏–∏. |

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
const store = createObservableStore<{ counter: number }>(
  { counter: 0 },
  [loggerMiddleware],
  { maxHistoryLength: 50, cleanupInterval: 60000 }
);
```

---

## üì¢ subscribe

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –°–ª—É—à–∞—Ç—å **–≤—Å–µ** –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
subscribe(
  callback: Subscriber<T>,
  cacheKeys?: CacheKey<T>[]
): Unsubscribe;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –ª—é–±–æ–º `update` (–∏–ª–∏ –ø—Ä—è–º–æ–º `state`-–ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–∏).
- –ú–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –º–∞—Å—Å–∏–≤—É `cacheKeys`.

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ò–º—è          | –¢–∏–ø                  | –û–ø–∏—Å–∞–Ω–∏–µ                                          |
| ------------ | -------------------- | ------------------------------------------------- |
| `callback`   | `(state: T) => void` | –§—É–Ω–∫—Ü–∏—è, –ø–æ–ª—É—á–∞—é—â–∞—è –Ω–æ–≤—ã–π —Å–Ω–∏–º–æ–∫ –≤—Å–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. |
| `cacheKeys?` | `CacheKey<T>[]`      | –°–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–π/–ø—É—Ç–µ–π –¥–ª—è —Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.  |

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
const unsubscribe = store.subscribe(
  (s) => console.log("–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:", s),
  [store.$.user.name, "customKey"]
);
```

---

## üéØ subscribeToPath

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ** –ø–æ–ª—è.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
subscribeToPath<P extends PathTracker<any, any>>(
  path: P,
  callback: Subscriber<P>,
  options?: {
    immediate?: boolean;
    cacheKeys?: CacheKey<T>[];
  }
): Unsubscribe;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ `path`.
- –û–ø—Ü–∏—è `immediate` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–∑–≤–∞—Ç—å –∫–æ–ª–±—ç–∫ —Å—Ä–∞–∑—É —Å —Ç–µ–∫—É—â–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ò–º—è        | –¢–∏–ø                                               | –û–ø–∏—Å–∞–Ω–∏–µ                                             |
| ---------- | ------------------------------------------------- | ---------------------------------------------------- |
| `path`     | `PathTracker<any, any>`                           | –¢—Ä–µ–∫–µ—Ä –ø—É—Ç–∏ (—á–µ—Ä–µ–∑ `store.$`).                       |
| `callback` | `(value: P[TYPE_SYMBOL]) => void`                 | –§—É–Ω–∫—Ü–∏—è, –ø–æ–ª—É—á–∞—é—â–∞—è –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –ø—É—Ç–∏.          |
| `options?` | `{ immediate?: boolean; cacheKeys?: CacheKey[] }` | `immediate`: —Å—Ä–∞–∑—É; `cacheKeys`: —Ñ–∏–ª—å—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π. |

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
store.subscribeToPath(
  store.$.user.age,
  (age) => console.log("–ù–æ–≤—ã–π –≤–æ–∑—Ä–∞—Å—Ç:", age),
  { immediate: true }
);
```

---

## ‚úèÔ∏è update

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –ò–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –ø—É—Ç–∏.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
update<P extends PathTracker<any, any>>(
  path: P,
  value:
    | P[typeof TYPE_SYMBOL]
    | ((cur: P[typeof TYPE_SYMBOL]) => P[typeof TYPE_SYMBOL])
): void;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é-–æ–±–Ω–æ–≤–∏—Ç–µ–ª—å.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é.

### üì• –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ò–º—è     | –¢–∏–ø                                         | –û–ø–∏—Å–∞–Ω–∏–µ                         |
| ------- | ------------------------------------------- | -------------------------------- |
| `path`  | `PathTracker<any, any>`                     | –¢—Ä–µ–∫–µ—Ä –ø—É—Ç–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª—è. |
| `value` | `NewValue` –∏–ª–∏ `(cur: Current) => NewValue` | –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è.      |

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
store.update(store.$.counter, (c) => c + 1);
store.update(store.$.user.name, "Alice");
```

---

## üîç get

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –ø—É—Ç–∏.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
get<P extends PathTracker<any, any>>(
  path: P
): P[typeof TYPE_SYMBOL] | undefined;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏–ª–∏ `undefined`, –µ—Å–ª–∏ –Ω–µ—Ç.

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
const email = store.get(store.$.user.contacts.email);
console.log("Email:", email);
```

---

## ‚ôªÔ∏è invalidate

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –§–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ —É–≤–µ–¥–æ–º–∏—Ç—å –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –ø–æ –∫–µ—à-–∫–ª—é—á—É.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
invalidate(
  cacheKey: CacheKey<T>,
): void;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- –ü–æ–≤—Ç–æ—Ä–Ω–æ ‚Äú–¥–µ—Ä–≥–∞–µ—Ç‚Äù –ø–æ–¥–ø–∏—Å–∫—É –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞.

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
store.invalidate(store.$.user.contacts.email);
store.invalidate("customCacheKeyEmail", true);
```

---

## ‚è≥ asyncUpdate

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –æ—Ç–º–µ–Ω–æ–π –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
asyncUpdate<P extends PathTracker<any, any>>(
  path: P,
  asyncUpdater: (
    cur: P[typeof TYPE_SYMBOL],
    signal: AbortSignal
  ) => Promise<P[typeof TYPE_SYMBOL]>
): Promise<void>;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `AbortSignal` –¥–ª—è –æ—Ç–º–µ–Ω—ã.
- –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –≤—ã–∑–æ–≤—ã –ø–æ —Ç–æ–º—É –∂–µ –ø—É—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω—è—é—Ç—Å—è.

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
await store.asyncUpdate(store.$.user.age, async (cur, signal) => {
  const res = await fetchAgeFromApi(signal);
  return res;
});
```

---

## üì¶ batch

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –æ–¥–Ω—É –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
batch(
  callback: () => void,
  isAsync?: boolean
): void;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- –ï—Å–ª–∏ `isAsync=true`, –∂–¥—ë—Ç `Promise` –≤–Ω—É—Ç—Ä–∏.
- –í—Å–µ `update` –∏ `asyncUpdate` –≤–Ω—É—Ç—Ä–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
await store.batch(async () => {
  store.update(store.$.counter, 5);
  await store.asyncUpdate(store.$.user.age, async (a) => a * 2);
}, true);
```

---

## ‚Ü©Ô∏è undo / ‚Ü™Ô∏è redo

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –û—Ç–º–µ–Ω–∏—Ç—å –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ –ø—É—Ç–∏.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
undo(path: PathTracker<any, any>): void;
redo(path: PathTracker<any, any>): void;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–∞–º, –≥–¥–µ –µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—è.
- `undo` ‚Üí –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–ª–æ–π, `redo` ‚Üí –æ–±—Ä–∞—Ç–Ω–æ.

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
const $StoreAge = store.$.user.age; // –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Å—ã–ª–∫—É –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
store.update($StoreAge, 40);
store.undo($StoreAge); // –≤–µ—Ä–Ω—É–ª–∏—Å—å –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
store.redo($StoreAge); // 40
```

---

## üõ£Ô∏è resolvePath

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –ü–æ–ª—É—á–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ø—É—Ç–∏ –≤ ‚Äúdot.notation‚Äù.

### ‚öôÔ∏è –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```ts
resolvePath(
  proxyPath: PathTracker<any, any> | string
): string;
```

### üìù –û–ø–∏—Å–∞–Ω–∏–µ

- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ç—Ä–µ–∫–µ—Ä –∏–ª–∏ —Å—Ç—Ä–æ–∫—É –≤ `"user.name"` –∏ —Ç. –¥.

### ‚ñ∂Ô∏è –ü—Ä–∏–º–µ—Ä

```ts
console.log(store.resolvePath(store.$.user.name)); // "user.name"
```

---

## üßπ manualCleanup

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –£–¥–∞–ª–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è –ø—É—Ç–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤.

```ts
manualCleanup(): void;
```

---

## üìä getMemoryStats

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: –ø–æ–¥–ø–∏—Å—á–∏–∫–∏, –∏—Å—Ç–æ—Ä–∏—è, –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏.

```ts
getMemoryStats(): MemoryStats;
```

---

## üóëÔ∏è clearStore

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
> –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—Å—Ç–∏—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ: –ø–æ–¥–ø–∏—Å–∫–∏, async-–∑–∞–¥–∞—á–∏, –∫–µ—à.

```ts
clearStore(): void;
```

---

## üè∑Ô∏è state / üõ†Ô∏è `$`

| –°–≤–æ–π—Å—Ç–≤–æ | –¢–∏–ø            | –û–ø–∏—Å–∞–Ω–∏–µ                                         |
| -------- | -------------- | ------------------------------------------------ |
| `state`  | `T`            | –ü—Ä–æ–∫—Å–∏-–æ–±—ä–µ–∫—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –ø—Ä—è–º–æ–≥–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è. |
| `$`      | `PathProxy<T>` | –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä ‚Äúpath trackers‚Äù –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫ –∏ update. |

---

## üîó –û–±—â–∏–π –ø—Ä–∏–º–µ—Ä

```ts
// –û–ø–∏—Å–∞–Ω–∏–µ –æ–±—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
interface AppState {
  counter: number; // –°—á—ë—Ç—á–∏–∫
  user: {
    // –û–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    name: string; // –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    age: number; // –í–æ–∑—Ä–∞—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    contacts: {
      // –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
      email: string; // Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      phone?: string; // –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω
      lol: {
        // –í–ª–æ–∂–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç LOL
        value: number; // –ó–Ω–∞—á–µ–Ω–∏–µ LOL
      };
    };
  };
}

// –ü–µ—Ä–≤–æ–µ middleware: —É–º–Ω–æ–∂–∞–µ—Ç —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ –Ω–∞ 2
const middlewareLogger1: Middleware<AppState> =
  (store, next) => (path, value) => {
    if (Number.isInteger(value)) {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ü–µ–ª–æ–µ –ª–∏ —á–∏—Å–ª–æ
      next(path, value * 2); // –ü–µ—Ä–µ–¥–∞—ë–º –≤ next –∑–Ω–∞—á–µ–Ω–∏–µ * 2
      return; // –ü—Ä–µ—Ä—ã–≤–∞–µ–º –¥–∞–ª–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
    }
    next(path, value); // –ò–Ω–∞—á–µ –ø–µ—Ä–µ–¥–∞—ë–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  };
// –í—Ç–æ—Ä–æ–µ middleware: –ª–æ–≥–≥–∏—Ä—É–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ (–Ω–µ—á–∏—Å–ª–æ–≤—ã–µ) –∑–Ω–∞—á–µ–Ω–∏—è
const middlewareLogger2: Middleware<AppState> =
  (store, next) => (path, value) => {
    console.log("not numbers", value, store.resolvePath(path)); // –í—ã–≤–æ–¥–∏–º –ø—É—Ç—å –∏ –∑–Ω–∞—á–µ–Ω–∏–µ
    next(path, value); // –ü–µ—Ä–µ–¥–∞—ë–º –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–ª—å—à–µ
  };

// –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å –Ω–∞—á–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º middleware
const store = createObservableStore<AppState>(
  {
    counter: 0, // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—á—ë—Ç—á–∏–∫–∞
    user: {
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      name: "John", // –ò–º—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
      age: 30, // –í–æ–∑—Ä–∞—Å—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
      contacts: {
        // –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        email: "john@example.com", // Email
        lol: { value: 2 }, // LOL –∑–Ω–∞—á–µ–Ω–∏–µ
      },
    },
  },
  [middlewareLogger1, middlewareLogger2]
);

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
store.subscribeToPath(store.$.user.age, (value) => {
  console.log("updated age:", value); // –õ–æ–≥–≥–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –≤–æ–∑—Ä–∞—Å—Ç
});

const $StoreAge = store.$.user.age; // –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Å—ã–ª–∫—É
store.update($StoreAge, 20); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–æ–∑—Ä–∞—Å—Ç –≤ 20
store.undo($StoreAge); // –û—Ç–º–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–≤–æ–∑–≤—Ä–∞—â–∞–µ–º 30)
store.redo($StoreAge); // –ü–æ–≤—Ç–æ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–≤–æ–∑–≤—Ä–∞—â–∞–µ–º 20)

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ email —Å –∫–µ—à-–∫–ª—é—á–æ–º
store.subscribe(
  (newStore) => {
    console.log("changed value email:", store.get(store.$.user.contacts.email)); // –õ–æ–≥–≥–∏—Ä—É–µ–º email
  },
  [store.$.user.contacts.email, "customCacheKeyEmail"] // –ö–µ—à-–∫–ª—é—á–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
);

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
store.subscribe((newStore) => {
  console.log("changed value:", newStore); // –õ–æ–≥–≥–∏—Ä—É–µ–º –≤—Å—ë —Å–æ—Å—Ç–æ—è–Ω–∏–µ
});

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –≤–æ–∑—Ä–∞—Å—Ç
store.subscribeToPath(store.$.user.age, (value) => {
  console.log("updated age", value); // –õ–æ–≥–≥–∏—Ä—É–µ–º –≤–æ–∑—Ä–∞—Å—Ç
});

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≤–æ–∑—Ä–∞—Å—Ç –∏ –∏–º—è —Å –∫–µ—à-–∫–ª—é—á–∞–º–∏
store.subscribeToPath(
  store.$.user.age, // –ü—É—Ç—å –∫ –≤–æ–∑—Ä–∞—Å—Ç—É
  (value) => {
    console.log("updated age:", value); // –õ–æ–≥–≥–∏—Ä—É–µ–º –≤–æ–∑—Ä–∞—Å—Ç
    console.log("updated name:", store.get(store.$.user.name)); // –õ–æ–≥–≥–∏—Ä—É–µ–º –∏–º—è
  },
  { cacheKeys: [store.$.user.name, "customCacheKeyName"] } // –ö–µ—à-–∫–ª—é—á–∏
);

// –ü—Ä–∏–º–µ—Ä –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –±–∞—Ç—á–∏–Ω–≥–∞
const test = async () => {
  console.log("invalidate –¥–ª—è email"); // –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è email
  await store.invalidate(store.$.user.contacts.email); // –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º –ø–æ –ø—É—Ç–∏
  await store.invalidate("customCacheKeyEmail"); // –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º –ø–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–º—É –∫–ª—é—á—É
  console.log("invalidate –¥–ª—è name"); // –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏
  await store.invalidate(store.$.user.name); // –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º –ø–æ –ø—É—Ç–∏
  await store.invalidate("customCacheKeyName"); // –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º –ø–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–º—É –∫–ª—é—á—É

  await store.batch(async () => {
    // –ù–∞—á–∞–ª–æ –±–∞—Ç—á–∞ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ)
    store.update(store.$.user.name, "QtPy"); // –ú–µ–Ω—è–µ–º –∏–º—è
    store.update(store.$.user.contacts.email, "my@emai.com"); // –ú–µ–Ω—è–µ–º email
    await store.asyncUpdate(
      store.$.user.age,
      async (
        cur // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —É–¥–≤–æ–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
      ) =>
        new Promise((resolve) =>
          setTimeout(() => {
            resolve(cur * 2);
          }, 2000)
        )
    );
    store.update(store.$.user.contacts.lol.value, 999999); // –ò–∑–º–µ–Ω—è–µ–º lol –∑–Ω–∞—á–µ–Ω–∏–µ
    store.update(store.$.counter, 2); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫
  }, true); // –ö–æ–Ω–µ—Ü –±–∞—Ç—á–∞

  await store.undo(store.$.user.age); // –û—Ç–º–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞
  setTimeout(() => {
    store.undo(store.$.user.age); // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–º–µ–Ω–∞ —á–µ—Ä–µ–∑ 200 –º—Å
  }, 200);

  // –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä—è–º–æ–≥–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ state-–ø—Ä–æ–∫—Å–∏
  store.state.counter += 23; // –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á—ë—Ç—á–∏–∫–∞ –Ω–∞–ø—Ä—è–º—É—é
  store.state.user.contacts.email = "233333333333"; // –ü—Ä—è–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ email
};
test();
```
